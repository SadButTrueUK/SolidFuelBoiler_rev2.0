-Версия 1.01
_________

1. Добавлено торможение двигателей противовключением (реверсом, время реверса  TIME_ROTATE_MOTOR_IN_REVERSE = 40 мс).
2. Увеличено время опроса датчика 220В до 7с.
3. Отключен Brown Out Detect по причине сброса МК при пуске двигателя (причина сброса просадка 5В по причине 
    просадки входных 12В от источника питания) и последующий сброс процессору по выходному сигналу супервизора.
4. Устранена ошибка - отсчёт времени отпускания концевика после начала движения двигателя и входе при этом в режим "Пауза"
5. Устранена ошибка - в режиме ожидания после входа в "Установку температуры" или "Установку оборотов вентилятора" не было входа 
    в режим "Чистка дымохода" по нажатию  удержанию в течение 5 сек кнопки "<<". 
6. Добавлены директивы препроцессора для компиляции и работы с отключенным датчиком газа и отключенном напряжении 220В;
7. Добавлена вторая подзвучка по окончанию длительного нажатия на кнопку;
8. При выводе по SPI данных в сдвиговый регистр наблюдалось зависание. Убрано ожидание сброса флага while(!PIR1bits.SSPIF);

Изменения на печатной плате:

1. На плате управления отпаян супервизор DA4. Цепь 5В проброшена на резистор R23. C17(0.1мкФ) включен после R23 (1кОм);
2. Возвращён выпаянный ранее конденсатор С2 (1000мкФх25В).


Версия 1.02
_________

1. Устранена ошибка в функции M_Motor_is_brake() (не в том месте стоял оператор return);
2. Устранена ошибка по лишнему торможению реверсом при инициализации, когда все механизмы уже находятся в начальном положении.
3. Устранена ошибка пропадания мигания индикатора после сброса аварии в режиме загрузки топлива.
4. Отключено торможение реверсом для ворошителя.

Изменения на печатной плате:

Отгорел сегмент минуса силового питания после испытаний - восстановлено;
Заменён сгоревший резистор (причина - обрыв пайки вывода симистора) R24 - восстановлено.
Вышел из строя после испытаний транзистор VT3 (по причине ошибки алгоритма торможения реверсом) - заменён. 
Восстановлена цепь -GND(-24V) - вывод резистора R43 не был подключен к этой цепи. 


Версия 1.03
_________

1. Увеличено время реверса при торможении двигателя TIME_ROTATE_MOTOR_IN_REVERSE до 60 мс.
2. В алгоритме загрузки топлива изменена последовательность работы дозатора и заслонки после работы ворошителя следующим образом:
заслонка открывается до срабатывания финишного концевика заслонки --> дозатор открывается до срабатывания финишного концевика дозатора -->
пауза 2 секунды --> дозатор закрывается до срабатывания  стартового концевика дозатора --> заслонка закрывается до срабатывания 
стартового концевика заслонки

//to do 
Период опроса датчика 220В увеличен до 10 с. Необходимо сокрректировать алгоритм определения 220В след. образом:
таймер опроса запускать на отсчёт 10 с только если в течение около 40 мс не приходят синхроимпульсы.
На плате поставить параллельно входу 12В резистор RC1206 10кОм для уменьшения времени разряда ёмкости источника питания


Версия 1.04
__________

1. На плате изменена (упрощена и модернизирована) схема датчика 220 В. Синхроимпульсы перехода через ноль напряжения 220В поступают с периодом 10мс
2. Изменён алгоритм фазового регулирования мощности для управления вентилятором.


Версия 1.05
___________

Выявлена ошибка:
При работе в режиме горения когда включена засыпка топлива и котёл переходит в режим поддержания температуры,
ворошитель не отключается.
Исправлен код функции M_Mngm_burning. 


Версия 1.06
___________

1. Увеличено значение максимальных попыток работы заслонки до появления признака аварии до 7;
2. Исправлена ошибка невозврата из режима автоподачи топлива (переход из редима горения) назад в горение; 
3. Исправлена ошибка отсутствия перехода в подрежим увеличения температуры при горении и остывании котла из подрежима поддержания;
4. Исправлена ошибка (добавленная в реpультате модификации кода) отсутствия входа в режим подачи топлива по длительному нажатию кнопки Inc из ожидания;
5. Добавлены новые директивы компилятора:
NO_SENSOR_GAS - отладка с отключенным датчиком исходящих газов;
NO_220V_SUPPLY - отладка без подачи 220В на плату управления;
VIEW_TEMPERATURE_GAS - отображение не температуры воды, а температуры газов на индикаторе;
NO_CONTROL_DRAUGHT - отключен контроль тяги по датчику газов в алгоритме горения;
6. Подкорректирован алгоритм модуля горения, связанный с вызовом выхода по таймаута из-за снижения температуры в режим ожидания;
7. Увеличено время проверки изменения концевика после начала движения двигателя до 1.5с;
8. Исправлена ошибка невыключения вентилятора при аварии в режиме горения;
9. Исправлена ошибка ошибочного вызова функции инкремента параметра по нажатию на кнопку декремент в режиме поддержания температуры при горении;
10. Время торможения реверсом уменьшено с 40мс до 30мс;
11. Добавлена директива препроцессора NO_CONTROL_FALSE_STATE_LS (для отключения обработки аварий ложного положения концевиков Е10...E14);

Изменения на печатной плате и в изделии в целом:
1. Отпаян преобразователь 12/5В. Питание цифровой части берётся от источника питания 220/5В;
2. Вышел из строя датчик температуры исходящих газов Pt100 (обрыв, при прозвонке сопротивлене около 1200 Ом). Причина неизвестна;


Версия 1.07
____________

1. При входе из режима ожидания в режим поддержания температуры в горении отсутствовало включение вентилятора - исправлено.
2. В режиме "Горение" по длительному нажатию на кнопку "Декремент" выводится температура датчика газов в формате d.xx
где хх - это tгазов/10. Повторное нажатие возвращает к индикации температуры воды.
3. В режиме "Загрузка топлива" (как при ручной подаче, так и из алгоритма горения) при появлении аварии после её сброса по кнопке и 
повторного нажатия на кнопку наюблюдался переход в режим "Горение" с постоянно работающим двигателем ворошителя - исправлено, 
переход в "Горение" осуществляется только при успешном окончании загрузки топлива.
4. Исправлена ошибка, проявляющаяся при установке температуры в горении  и попадании при этом в режим поддержания температуры.
 

Версия 1.08
____________

1. Добавлены новые страницы пользовательского меню.
2. Значительно модернизирован алгоритм работы котла в режиме "Горение".


Версия 1.09
____________

1. В начальной конфигурации убран плавный пуск двигателя ворошителя.
2. При старте вентилятора добавлен режим форсированного старта (на 5 секунд вентилятор включается на уровень 3)


Версия 1.10
___________

1. Изменено время работы ворощителя до 10с
2. Изменен период опроса датчика ворошителя до 8.5 секунд
3. Исправлена ошибка индикации светодиода "Вентилятор" в режиме "Горение"
4. Время разгона вентилятора увеличено до 15 секунд.


Версия 1.11
___________

1. Изменены в меню времена плавного пуска двигателей дозатора и заслонки
2. Увеличено время начала опроса ложного положения концевиков после начала движения двигателя до 3 с.
3. Изменён алгоритм опроса ложного положения концевиков при включенной директиве препроцессора NO_CONTROL_FALSE_STATE_LS
4. Исключен переход в режим разгона вентилятора после какой-либо из аварий.


Версия 1.12
___________

1. Добавлено обнуление счётчика таймера, по которому в модуле управдения отслеживалось возможное уменьшение температуры в режиме "Горение"


Версия 1.13
___________

1. Устранена ошибка, выраженная в том что во время автозагрузки топлива в режиме горения не отклчался вентилятор
2. В заводских установках уменьшено время форсажа вентилятора при розжиге котла


Версия 1.14
___________

1. Уменьшены обороты вентилятора при переходе из режима тления в горение после загрузки топлива
2. Исправлены ошибки таймера автовыхода при ненажатии ни на одну из кнопок в пользовательском меню.


Версия 1.15
___________

1. Изменены константы времени работы форсажа вентилятора при его пуске в сторону их уменьшения


Версия 2.00
___________

Реализация для плат управления и индикации 2-ой ревизии. Код переписан для PIC87J50
1. Обнаруженные ошибки на схеме блока управления, которые нужно исправить:
    1.1 Неправильно подключен концевик крышки к оптрону V10; - СДЕЛАНО
    1.2 Неправильно подключен конденсатор С42; - СДЕЛАНО
    1.3 На МК цепи SOUND(к.57) и IS8(к.46) поменять местами с доработкой печатной платы (привязка датчика ворощителя к входу внешнего прерывания) - СДЕЛАНО
    1.4 Установить подтягивающий резистор между цепью IS8 и питанием 3.3В  - СДЕЛАНО (установлен 4.7к)
2.  Обнаруженные ошибки на печатной плате блока управления, которые нужно исправить:
    2.1 Нужно удалить контур макетной платы адаптера QFTP64/QFTP80/QFTP100 в слое Board (или перенести его в неиспользуемый слой). - СДЕЛАНО

to do!!!!
---------
24/11/2019 При прогоне кода на симуляторе обнаружено зависание в функции M_Ind_bin2dec
в цикле
while(value >= decimals_temp) 
{ 
    value -= decimals_temp;  
    (M_Ind_data.data[count])++;
}
Причина - выход за размер массива  - СДЕЛАНО

1. В функции M_Ind_LED_blinking сделать мигание светодиода Pump;
2. На плате индикации установлен 7-сегментный индикатор с общим анодом. Поэтому на плате управления 
 VT1...VT3, VT5...VT7 нужно заменить на BC858 отрезать их эмиттеры от цепи GND и подключить к цепи 3.3V; - СДЕЛАНО. В ПЭ3 ОТКОРРЕКТИРОВАТЬ ТИП 7-СЕГМ ИНД. 
3. Исправить ошибки тактирования, а также отсутствие обработки сброса сторожевого таймера - СДЕЛАНО
4. Принять решение о целесооразности оптимизаций кода (при полной оптимизации большой разброс по периоду выполнения задач)
5. Разобраться с выводом на индикацию в программном SPI - СДЕЛАНО (время вывода составило 17 мкс)
6. Подключить второй индикатор - пока алгоритм работает с ошибками!
7. Исправить ошибки с размерностями буфера параметров меню - СДЕЛАНО
8. Исправить абсолютные индексы в таблице минимумов-максимумов параметров меню !!! - СДЕЛАНО
9. Исправить ошибки в индикации - причина в неправильном выводе в сдвиговый регистр - СДЕЛАНО
10. Температура на линейном стабилизаторе напряжения DA2 63 градуса. Целесообразнее использовать схему на MC33(4)063  - НА БУДУЩИЙ РЕЛИЗ ПЛАТЫ!!!
11. Установить подтягивающий резистор между к.4 V2 и цепью 3.3V (причина - отсутствие подтягивающих резисторов на порту С) - ДОБАВЛЕН НА СХЕМУ R125
12. Имеется небольшое подмигивание неиспользуемых сегментов индикатора - ВОЗМОЖНО НУЖНО УВЕЛИЧИТЬ ТОКООГРАНИЧИВАЮЩИЕ РЕЗИСТОРЫ!!!
13. Добавить обработку перегрузки по току по 12В (например, при заклинивании двигателя)
14. Ошибка в подключении пульта имитаторов концевиков и датчиков температуры - СДЕЛАНО (кинуть одну цепь от имитатора концевика крышки)
(раскомментировать M_LI_Limit_Sw.ls_hopper_cover_state = M_LI_is_LS_worked(LS_HOPPER_COVER_PIN, LS_IS_WORKED_TO_NC); после доработки
